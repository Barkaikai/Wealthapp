1ï¸âƒ£ Ensure your package.json is correct

Open package.json and verify:

{
  "name": "your-app",
  "version": "1.0.0",
  "scripts": {
    "preinstall": "npm ci || npm install",
    "build": "tsc",
    "start": "node dist/index.js"
  },
  "dependencies": {
    "axios": "^1.7.0",
    "express": "^4.19.0"
  },
  "devDependencies": {
    "typescript": "^5.4.0"
  }
}


Important:
âœ… axios must be under "dependencies"
ğŸš« NOT under "devDependencies"

Run this once locally in your Replit shell:

npm install axios --save


Commit the updated package.json and package-lock.json.

2ï¸âƒ£ Add a Replit Deploy Hook Script

Create a file called:
ğŸ“ scripts/deploy-setup.sh

#!/usr/bin/env bash
set -e
echo "ğŸ§© Setting up production build for Replit Deploy..."

# Clean previous installs
rm -rf node_modules dist
npm cache clean --force || true

# Install all dependencies (prod + build-time)
npm ci || npm install --omit=dev=false

# Verify axios and express exist
for pkg in axios express; do
  if ! npm list "$pkg" >/dev/null 2>&1; then
    echo "âš ï¸ Missing $pkg, installing..."
    npm install "$pkg"
  fi
done

# Build TypeScript if applicable
if [ -f "tsconfig.json" ]; then
  echo "ğŸ—  Building TypeScript..."
  npx tsc
fi

echo "âœ… Build setup complete!"


Then make it executable:

chmod +x scripts/deploy-setup.sh

3ï¸âƒ£ Update Replit Deploy Config

If youâ€™re using Replit Deploy (GUI):

Click Deployments â†’ Configure Build

Set:

Phase	Command
Build command	bash scripts/deploy-setup.sh
Run command	npm start

This ensures Replit installs all dependencies before trying to start your app.

If youâ€™re using .replit or replit.nix, add this line to .replit:

run = "bash scripts/deploy-setup.sh && npm start"

4ï¸âƒ£ Clean and Redeploy

Now re-run from the Replit shell:

bash scripts/deploy-setup.sh
npm start


If it runs fine locally, hit Deploy â†’ Publish.

âœ… What This Fix Does

âœ” Ensures all dependencies (like axios) are installed before build
âœ” Works with Replitâ€™s â€œephemeralâ€ deploy environment
âœ” Handles both TypeScript and JS builds
âœ” Guarantees a clean, reproducible build every time