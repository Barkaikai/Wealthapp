Fix: Dynamic Port Detection
1ï¸âƒ£ Update your server/index.ts (or main server file)

Find your line like this:

const PORT = 5000;


and replace it with:

const PORT = process.env.PORT || 5000;


Then scroll down to your listen statement and keep it as:

app.listen(PORT, () => {
  console.log(`[express] âœ… Server running on port ${PORT}`);
});


Thatâ€™s it â€” Node will automatically detect Replitâ€™s assigned port when hosted there.

2ï¸âƒ£ Fix your .replit config file

Open the .replit file and make sure it looks like this:

run = "npm run dev"
env = {
  "PORT": "3000"
}


ğŸŸ¢ OR (better) â€” remove the hardcoded port entirely so Replit manages it dynamically:

run = "npm run dev"


Replit automatically injects its dynamic port variable (like 44775) into process.env.PORT.

3ï¸âƒ£ Optional: Fix replit.nix (if using Nix-based repl)

Ensure your replit.nix includes Node like this:

{ pkgs }: {
  deps = [
    pkgs.nodejs-18_x
    pkgs.npm
  ];
}


This ensures youâ€™re running a compatible Node version for process.env.PORT.

4ï¸âƒ£ Test it inside Replit Console

Open the Shell tab (bottom or side) and run:

echo $PORT


You should see a number like 44775 â€” thatâ€™s the live port Replit assigned.

Now run:

npm run dev


And you should see:

[express] âœ… Server running on port 44775


When you click â€œOpen in Browserâ€, it should open your app successfully.

âš™ï¸ Bonus Fix: Garbage Collection Warning (Optional)

Since youâ€™re already using Replit, you canâ€™t use --expose-gc.
So silence the warning safely like this in your HealthMonitor:

if (global.gc) {
  global.gc();
  console.log("[HealthMonitor] Manual GC triggered successfully.");
} else {
  console.log("[HealthMonitor] GC not available on this platform (Replit). Skipping safely.");
}


This prevents the repeating â€œâš ï¸ Garbage collection not exposedâ€ message.

âœ… Final Working Summary

After changes, your startup log should look like this:

[express] CSRF protection enabled
[express] âœ… Server running on port 44775
[HealthMonitor] âœ“ GC not available on this platform, skipping safely
[DB] Connection pool initialized successfully
[AutomationScheduler] âœ“ All tasks scheduled and ready
[AppLogger] âœ… AI Data Batch: 1 events
